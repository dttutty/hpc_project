import pandas as pd
import matplotlib.pyplot as plt
import os

# 数据文件内容
data = """
Matrix Size,Sparsity,Jacobi-OMP,Gauss-Seidel,Gauss-Seidel-OMP
100,0.1,94.2,3.4,14.6
200,0.1,62.4,8.6,30.0
300,0.1,85.8,16.6,52.2
400,0.1,119.2,34.2,70.8
500,0.1,174.6,44.4,93.8
600,0.1,315.2,62.0,128.0
700,0.1,324.6,83.0,174.0
800,0.1,526.6,108.0,181.4
900,0.1,632.2,143.2,273.4
1000,0.1,947.8,174.0,309.0
1100,0.1,1023.6,221.6,349.4
1200,0.1,1215.0,278.8,441.6
1300,0.1,1807.2,335.4,505.4
1400,0.1,1880.8,391.8,579.4
1500,0.1,2742.8,480.4,678.2
1600,0.1,3330.2,558.2,757.0
1700,0.1,4294.4,700.4,875.6
1800,0.1,4781.8,826.8,1057.4
1900,0.1,6471.8,1013.8,1184.6
2000,0.1,10060.0,1470.2,2811.0
100,0.9,51.6,3.0,4.0
200,0.9,56.8,8.6,7.0
300,0.9,49.6,16.6,10.0
400,0.9,31.2,36.0,13.8
500,0.9,58.8,42.4,18.2
600,0.9,58.0,60.6,26.8
700,0.9,95.4,103.4,31.0
800,0.9,86.6,107.6,35.6
900,0.9,133.4,137.0,43.4
1000,0.9,150.8,188.0,49.8
1100,0.9,171.0,232.0,55.8
1200,0.9,139.8,266.2,63.8
1300,0.9,221.2,358.0,72.8
1400,0.9,415.8,439.6,89.2
1500,0.9,344.6,504.6,101.6
1600,0.9,476.4,591.6,117.4
1700,0.9,639.2,707.8,127.0
1800,0.9,562.2,814.4,142.4
1900,0.9,877.6,1025.0,143.4
2000,0.9,1313.0,1142.0,154.8
100,0.99,27.8,3.0,4.0
200,0.99,17.8,8.0,7.0
300,0.99,35.2,15.6,9.8
400,0.99,48.8,32.2,13.0
500,0.99,30.4,40.2,18.0
600,0.99,42.2,62.8,27.4
700,0.99,22.4,77.2,26.6
800,0.99,46.6,107.2,28.0
900,0.99,53.4,130.8,34.0
1000,0.99,49.6,176.6,39.2
1100,0.99,46.4,214.4,48.0
1200,0.99,70.0,268.6,49.4
1300,0.99,63.8,333.2,55.2
1400,0.99,91.0,381.6,60.2
1500,0.99,104.6,456.0,66.4
1600,0.99,92.0,575.4,72.8
1700,0.99,130.2,708.8,98.0
1800,0.99,150.0,797.4,111.8
1900,0.99,129.2,958.2,102.8
2000,0.99,153.4,1124.0,114.8
"""

# enlarge the main part of the figure by removing some data points (of Jacobi OMP) of which execution times > 1500ms
data = """
Matrix Size,Sparsity,Jacobi-OMP,Gauss-Seidel,Gauss-Seidel-OMP
100,0.1,94.2,3.4,14.6
200,0.1,62.4,8.6,30.0
300,0.1,85.8,16.6,52.2
400,0.1,119.2,34.2,70.8
500,0.1,174.6,44.4,93.8
600,0.1,315.2,62.0,128.0
700,0.1,324.6,83.0,174.0
800,0.1,526.6,108.0,181.4
900,0.1,632.2,143.2,273.4
1000,0.1,947.8,174.0,309.0
1100,0.1,1023.6,221.6,349.4
1200,0.1,1215.0,278.8,441.6
1300,0.1,,335.4,505.4
1400,0.1,,391.8,579.4
1500,0.1,,480.4,678.2
1600,0.1,,558.2,757.0
1700,0.1,,700.4,875.6
1800,0.1,,826.8,1057.4
1900,0.1,,1013.8,1184.6
2000,0.1,,1470.2,
100,0.9,51.6,3.0,4.0
200,0.9,56.8,8.6,7.0
300,0.9,49.6,16.6,10.0
400,0.9,31.2,36.0,13.8
500,0.9,58.8,42.4,18.2
600,0.9,58.0,60.6,26.8
700,0.9,95.4,103.4,31.0
800,0.9,86.6,107.6,35.6
900,0.9,133.4,137.0,43.4
1000,0.9,150.8,188.0,49.8
1100,0.9,171.0,232.0,55.8
1200,0.9,139.8,266.2,63.8
1300,0.9,221.2,358.0,72.8
1400,0.9,415.8,439.6,89.2
1500,0.9,344.6,504.6,101.6
1600,0.9,476.4,591.6,117.4
1700,0.9,639.2,707.8,127.0
1800,0.9,562.2,814.4,142.4
1900,0.9,877.6,1025.0,143.4
2000,0.9,1313.0,1142.0,154.8
100,0.99,27.8,3.0,4.0
200,0.99,17.8,8.0,7.0
300,0.99,35.2,15.6,9.8
400,0.99,48.8,32.2,13.0
500,0.99,30.4,40.2,18.0
600,0.99,42.2,62.8,27.4
700,0.99,22.4,77.2,26.6
800,0.99,46.6,107.2,28.0
900,0.99,53.4,130.8,34.0
1000,0.99,49.6,176.6,39.2
1100,0.99,46.4,214.4,48.0
1200,0.99,70.0,268.6,49.4
1300,0.99,63.8,333.2,55.2
1400,0.99,91.0,381.6,60.2
1500,0.99,104.6,456.0,66.4
1600,0.99,92.0,575.4,72.8
1700,0.99,130.2,708.8,98.0
1800,0.99,150.0,797.4,111.8
1900,0.99,129.2,958.2,102.8
2000,0.99,153.4,1124.0,114.8
"""

# 将数据加载为DataFrame
from io import StringIO
df = pd.read_csv(StringIO(data))

# 筛选数据并绘图
plt.figure(figsize=(12, 8))

sparsities = df['Sparsity'].unique()
methods = ['Jacobi-OMP', 
           'Gauss-Seidel', 
           'Gauss-Seidel-OMP']

for sparsity in sparsities:
    for method in methods:
        subset = df[df['Sparsity'] == sparsity]
        label = f"{method}, Sparsity:{sparsity} "
        color = ['black', 'red', 'pink'][list(sparsities).index(sparsity)]
        marker = ['o', 's', '^'][methods.index(method)]
        plt.plot(subset['Matrix Size'], subset[method], marker=marker, color=color, label=label, linewidth=1)

# 添加图例和标签
plt.title("Execution Time vs Matrix Size for Different Methods and Sparsities", fontsize=14)
plt.xlabel("Matrix Size", fontsize=12)
plt.ylabel("Execution Time (ms)", fontsize=12)
plt.grid(True, linestyle="--", alpha=0.7)
plt.legend(fontsize=10)
plt.tight_layout()

# 显示图形
script_dir = os.path.dirname(os.path.abspath(__file__))
plt.savefig(os.path.join(script_dir, 'result_enlarge.png'))
